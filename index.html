<script language=JavaScript> html='%3C%21DOCTYPE%20html%3E%0D%0A%3Chtml%20lang%3D%22ru%22%3E%0D%0A%3Chead%3E%0D%0A%20%20%20%20%3Cmeta%20charset%3D%22UTF-8%22%3E%0D%0A%20%20%20%20%3Cmeta%20name%3D%22viewport%22%20content%3D%22width%3Ddevice-width%2C%20initial-scale%3D1.0%22%3E%0D%0A%20%20%20%20%3Ctitle%3EKRNT%20Checker%20%3C%2Ftitle%3E%0D%0A%20%20%20%20%3Cscript%20src%3D%22https%3A%2F%2Fcdn.tailwindcss.com%22%3E%3C%2Fscript%3E%0D%0A%20%20%20%20%3Cscript%20src%3D%22https%3A%2F%2Fcdnjs.cloudflare.com%2Fajax%2Flibs%2Fjszip%2F3.10.1%2Fjszip.min.js%22%3E%3C%2Fscript%3E%0D%0A%20%20%20%20%3Cstyle%3E%0D%0A%20%20%20%20%20%20%20%20%40import%20url%28%27https%3A%2F%2Ffonts.googleapis.com%2Fcss2%3Ffamily%3DInter%3Awght%40100..900%26display%3Dswap%27%29%3B%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%3Aroot%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20--bg-main%3A%20%230D1117%3B%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20--bg-card%3A%20%23161B22%3B%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20--bg-list%3A%20%230D1117%3B%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20--color-text-primary%3A%20%23C9D1D9%3B%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20--color-text-secondary%3A%20%238B949E%3B%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20--color-accent%3A%20%2334D399%3B%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20--color-danger%3A%20%23F87171%3B%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20--color-warning%3A%20%23FBBF24%3B%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20--color-safe%3A%20%2334D399%3B%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20--color-low-risk%3A%20%237C3AED%3B%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20--border-color%3A%20%2330363D%3B%20%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20body%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20font-family%3A%20%27Inter%27%2C%20sans-serif%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20background-color%3A%20var%28--bg-main%29%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20min-height%3A%20100vh%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20display%3A%20flex%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20align-items%3A%20flex-start%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20justify-content%3A%20center%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20padding%3A%201.5rem%201rem%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3A%20var%28--color-text-primary%29%3B%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20.solid-card%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20background%3A%20var%28--bg-card%29%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20border-radius%3A%2012px%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20border%3A%201px%20solid%20var%28--border-color%29%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20box-shadow%3A%200%204px%2010px%20rgba%280%2C%200%2C%200%2C%200.2%29%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20transition%3A%20box-shadow%200.2s%3B%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20.list-group%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20border-radius%3A%208px%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20overflow%3A%20hidden%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20background%3A%20var%28--bg-list%29%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20border%3A%201px%20solid%20var%28--border-color%29%3B%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20.list-group-header%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20padding%3A%208px%2016px%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20font-size%3A%200.75rem%3B%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20font-weight%3A%20500%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3A%20var%28--color-text-secondary%29%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20text-transform%3A%20uppercase%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20letter-spacing%3A%200.05em%3B%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20.list-item%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20padding%3A%2012px%2016px%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20border-bottom%3A%201px%20solid%20rgba%28255%2C%20255%2C%20255%2C%200.1%29%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20transition%3A%20background%200.1s%3B%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20.list-item%3Alast-child%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20border-bottom%3A%20none%3B%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20.list-item%3Ahover%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20background%3A%20rgba%28255%2C%20255%2C%20255%2C%200.05%29%3B%20%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20.action-btn%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20background-color%3A%20var%28--color-accent%29%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3A%20var%28--bg-main%29%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20font-weight%3A%20700%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20border-radius%3A%208px%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20transition%3A%20all%200.2s%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20box-shadow%3A%200%204px%208px%20rgba%2852%2C%20211%2C%20153%2C%200.4%29%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20border-bottom%3A%203px%20solid%20%231E8056%3B%20%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20.action-btn%3Aactive%3Anot%28%3Adisabled%29%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20transform%3A%20translateY%282px%29%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20box-shadow%3A%20none%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20border-bottom%3A%201px%20solid%20%231E8056%3B%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20.action-btn%3Ahover%3Anot%28%3Adisabled%29%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20background-color%3A%20%232fb686%3B%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20.action-btn%3Adisabled%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20opacity%3A%200.4%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20cursor%3A%20not-allowed%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20box-shadow%3A%20none%3B%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%23fileLabel%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20background%3A%20var%28--bg-main%29%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20border%3A%201px%20solid%20var%28--border-color%29%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20border-radius%3A%208px%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20cursor%3A%20pointer%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20transition%3A%20background%200.15s%3B%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%23fileLabel%3Ahover%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20background%3A%20%2310161f%3B%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20%23riskScoreContainer%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20padding%3A%2012px%2020px%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20border-radius%3A%208px%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20display%3A%20flex%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20align-items%3A%20center%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20justify-content%3A%20space-between%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20border%3A%201px%20solid%20var%28--border-color%29%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20background%3A%20rgba%28255%2C%20255%2C%20255%2C%200.05%29%3B%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20.spinner%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20border%3A%204px%20solid%20rgba%28255%2C%20255%2C%20255%2C%200.3%29%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20border-top%3A%204px%20solid%20var%28--color-accent%29%3B%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20border-radius%3A%2050%25%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20width%3A%2040px%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20height%3A%2040px%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20animation%3A%20spin%201s%20linear%20infinite%3B%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%40keyframes%20spin%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%200%25%20%7B%20transform%3A%20rotate%280deg%29%3B%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20100%25%20%7B%20transform%3A%20rotate%28360deg%29%3B%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20.evidence-line%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20display%3A%20block%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20margin-top%3A%206px%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20font-family%3A%20monospace%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20font-size%3A%200.7rem%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3A%20%234B5563%3B%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20background-color%3A%20%231F2937%3B%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20padding%3A%206px%208px%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20border-radius%3A%204px%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20overflow-x%3A%20auto%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20white-space%3A%20nowrap%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20max-width%3A%20100%25%3B%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20.compatibility-warning%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20background-color%3A%20rgba%28248%2C%20113%2C%20113%2C%200.1%29%3B%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20border%3A%201px%20solid%20var%28--color-danger%29%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20padding%3A%201rem%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20border-radius%3A%208px%3B%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20.tab-button%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20padding%3A%2010px%2018px%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20font-weight%3A%20600%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20border-radius%3A%206px%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20transition%3A%20all%200.15s%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3A%20var%28--color-text-secondary%29%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20background-color%3A%20transparent%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20width%3A%2050%25%3B%20%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20%20%20%20%20.tab-button.active%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3A%20var%28--color-text-primary%29%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20background-color%3A%20var%28--border-color%29%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20box-shadow%3A%200%201px%203px%20rgba%280%2C%200%2C%200%2C%200.2%29%3B%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20.evidence-button-open%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3A%20var%28--bg-main%29%20%21important%3B%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20background%3A%20var%28--color-accent%29%20%21important%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20box-shadow%3A%200%201px%203px%20rgba%2852%2C%20211%2C%20153%2C%200.4%29%3B%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%3C%2Fstyle%3E%0D%0A%3C%2Fhead%3E%0D%0A%3Cbody%3E%0D%0A%0D%0A%20%20%20%20%3Cdiv%20id%3D%22app-container%22%20class%3D%22w-full%20max-w-xl%20mx-auto%20space-y-6%20pb-12%22%3E%0D%0A%0D%0A%20%20%20%20%20%20%20%20%3Cheader%20class%3D%22text-center%20pt-4%22%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Ch1%20class%3D%22text-3xl%20font-extrabold%20tracking-tight%22%3EKRNT%3Cspan%20style%3D%22color%3Avar%28--color-danger%29%22%3E%27e%3C%2Fspan%3E%20Checker%20%3Cspan%20class%3D%22text-lg%22%3E%28%D1%85%D0%B8%D1%80%D0%BE%D0%BA%D0%BE%D0%B4%29%3C%2Fspan%3E%3C%2Fh1%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cp%20class%3D%22text-sm%20mt-1%22%20style%3D%22color%3Avar%28--color-text-secondary%29%22%3E%D0%90%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7%20%D0%BE%D1%82%D1%87%D0%B5%D1%82%D0%BE%D0%B2%20%7C%20%2A%2A%D1%85%D0%B8%D1%80%D0%BA%D0%BE%D0%B4%2A%2A%3C%2Fp%3E%0D%0A%20%20%20%20%20%20%20%20%3C%2Fheader%3E%0D%0A%0D%0A%0D%0A%20%20%20%20%20%20%20%20%3Cdiv%20id%3D%22main-card%22%20class%3D%22solid-card%20p-5%20space-y-4%22%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class%3D%22flex%20justify-between%20p-1%20rounded-lg%22%20style%3D%22background%3A%20var%28--bg-main%29%3B%20border%3A%201px%20solid%20var%28--border-color%29%3B%22%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20id%3D%22tab-ios%22%20class%3D%22tab-button%22%20onclick%3D%22switchMode%28%27ios%27%29%22%3EiOS%20%28.ips%29%3C%2Fbutton%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20id%3D%22tab-android%22%20class%3D%22tab-button%22%20onclick%3D%22switchMode%28%27android%27%29%22%3EAndroid%20%28.txt%2C%20.log%29%3C%2Fbutton%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cinput%20type%3D%22file%22%20id%3D%22fileInput%22%20accept%3D%22.ips%22%20class%3D%22hidden%22%20onchange%3D%22handleFileSelection%28event%29%22%3E%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Clabel%20id%3D%22fileLabel%22%20for%3D%22fileInput%22%20class%3D%22flex%20items-center%20justify-between%20p-4%20solid-card%20cursor-pointer%20transition%20duration-200%22%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class%3D%22flex%20items-center%20space-x-3%22%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Csvg%20class%3D%22w-6%20h-6%22%20style%3D%22color%3Avar%28--color-accent%29%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22none%22%20stroke%3D%22currentColor%22%20stroke-width%3D%222%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cpath%20d%3D%22M14.5%202H6a2%202%200%200%200-2%202v16a2%202%200%200%200%202%202h12a2%202%200%200%200%202-2V7.5L14.5%202L14.5%202z%22%3E%3C%2Fpath%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cpolyline%20points%3D%2214%202%2014%208%2020%208%22%3E%3C%2Fpolyline%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fsvg%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cspan%20id%3D%22fileNameDisplay%22%20class%3D%22font-medium%20text-base%20truncate%22%20style%3D%22color%3Avar%28--color-text-primary%29%22%3E%D0%92%D1%8B%D0%B1%D0%B5%D1%80%D0%B8%D1%82%D0%B5%20%D1%84%D0%B0%D0%B9%D0%BB%20%D0%BE%D1%82%D1%87%D0%B5%D1%82%D0%B0%20%28.ips%29...%3C%2Fspan%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Csvg%20class%3D%22w-5%20h-5%22%20style%3D%22color%3Avar%28--color-text-secondary%29%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22none%22%20stroke%3D%22currentColor%22%20stroke-width%3D%222%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cpolyline%20points%3D%229%2018%2015%2012%209%206%22%3E%3C%2Fpolyline%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fsvg%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Flabel%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cp%20id%3D%22fileInstruction%22%20class%3D%22text-xs%20text-center%20pt-2%22%20style%3D%22color%3Avar%28--color-text-secondary%29%22%3E%D0%9E%D0%B6%D0%B8%D0%B4%D0%B0%D0%B5%D1%82%D1%81%D1%8F%20%D0%BE%D1%82%D1%87%D0%B5%D1%82%20iOS%20%28.ips%29%3C%2Fp%3E%0D%0A%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20id%3D%22analyzeButton%22%20onclick%3D%22startAnalysis%28%29%22%20class%3D%22w-full%20py-3%20action-btn%22%20disabled%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%D0%9D%D0%B0%D1%87%D0%B0%D1%82%D1%8C%20%20iOS%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fbutton%3E%0D%0A%0D%0A%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%3Cdiv%20id%3D%22loadingOverlay%22%20class%3D%22hidden%20fixed%20inset-0%20z-50%20flex%20items-center%20justify-center%20bg-black%20bg-opacity-80%22%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class%3D%22flex%20flex-col%20items-center%20solid-card%20p-8%20shadow-2xl%22%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class%3D%22spinner%20mb-4%22%3E%3C%2Fdiv%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cp%20id%3D%22loadingText%22%20class%3D%22text-xl%20font-bold%20text-white%22%3E%20%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7...%3C%2Fp%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cp%20id%3D%22loadingSubText%22%20class%3D%22text-sm%20mt-2%22%20style%3D%22color%3Avar%28--color-text-secondary%29%22%3E-%20%D0%BF%D0%BE%D0%B8%D1%81%D0%BA%20...%3C%2Fp%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0D%0A%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0D%0A%0D%0A%20%20%20%20%20%20%20%20%3Cdiv%20id%3D%22resultsContainer%22%20class%3D%22hidden%20solid-card%20p-5%20space-y-5%22%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id%3D%22iosCompatibilityWarning%22%20class%3D%22compatibility-warning%20space-y-2%20hidden%22%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class%3D%22text-sm%20font-bold%20flex%20items-center%20space-x-2%22%20style%3D%22color%3Avar%28--color-danger%29%22%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Csvg%20class%3D%22w-4%20h-4%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22none%22%20stroke%3D%22currentColor%22%20stroke-width%3D%222%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%3E%3Cpath%20d%3D%22M10.29%203.86L1.82%2018a2%202%200%200%200%201.71%203h16.94a2%202%200%200%200%201.71-3L13.71%203.86a2%202%200%200%200-3.42%200z%22%3E%3C%2Fpath%3E%3Cline%20x1%3D%2212%22%20y1%3D%229%22%20x2%3D%2212%22%20y2%3D%2213%22%3E%3C%2Fline%3E%3Cline%20x1%3D%2212%22%20y1%3D%2217%22%20x2%3D%2212.01%22%20y2%3D%2217%22%3E%3C%2Fline%3E%3C%2Fsvg%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cspan%3E%D0%92%D0%90%D0%96%D0%9D%D0%9E%3A%20%D0%A1%D0%BE%D0%B2%D0%BC%D0%B5%D1%81%D1%82%D0%B8%D0%BC%D0%BE%D1%81%D1%82%D1%8C%20%D0%9E%D0%A1%3C%2Fspan%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cp%20id%3D%22compatibilityText%22%20class%3D%22text-sm%20font-medium%22%20style%3D%22color%3A%23FFFFFFCC%22%3E%3C%2Fp%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0D%0A%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id%3D%22riskScoreContainer%22%20class%3D%22mt-2%22%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class%3D%22text-xs%20font-medium%20uppercase%20tracking-wider%22%20style%3D%22color%3Avar%28--color-text-secondary%29%22%3E%D0%9E%D0%B1%D1%89%D0%B8%D0%B9%20%D0%A0%D0%B8%D1%81%D0%BA%20%D0%9C%D0%BE%D0%B4%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D0%B8%3C%2Fdiv%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id%3D%22riskScoreDisplay%22%20class%3D%22text-2xl%20font-extrabold%22%20style%3D%22color%3Avar%28--color-text-primary%29%22%3E0.00%25%3C%2Fdiv%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id%3D%22riskVerdict%22%20class%3D%22text-sm%20font-semibold%20flex%20items-center%20justify-center%20space-x-2%20border-b%20pb-4%22%20style%3D%22border-color%3A%20var%28--border-color%29%3B%22%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class%3D%22space-y-2%22%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class%3D%22list-group-header%22%3E%D0%98%D0%BD%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%86%D0%B8%D1%8F%20%D0%BE%D0%B1%20%D0%A3%D1%81%D1%82%D1%80%D0%BE%D0%B9%D1%81%D1%82%D0%B2%D0%B5%3C%2Fdiv%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id%3D%22deviceInfo%22%20class%3D%22list-group%22%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0D%0        let valueColor;
        let isMono = false;
        let evidenceBlock = '';

        if (type === 'risk') {
            isMono = true;
            if (riskValue >= 40) { 
                iconHtml = icons.highRisk;
                valueColor = 'color:var(--color-danger)';
            } else if (riskValue >= 25) {
                iconHtml = icons.mediumRisk;
                valueColor = 'color:var(--color-warning)';
            } else {
                iconHtml = icons.lowRisk;
                valueColor = 'color:var(--color-low-risk)';
            }
            valueDisplay = `+${riskValue} RP`;
            
            if (evidence) {
                const cleanEvidence = evidence.replace(/\s+/g, ' ').trim();
                evidenceBlock = `<span class="evidence-line" title="Найденная строка (в контексте)">${cleanEvidence.substring(0, 100)}${cleanEvidence.length > 100 ? '...' : ''}</span>`;
            }

        } else if (type === 'info') { 
            valueDisplay = riskValue; 
            if (['N/A', 'Не найдено', 'Оригинал', 'Оригинал (Locked)', 'Неизвестно'].includes(valueDisplay) || valueDisplay.includes('Undetected') || valueDisplay.includes('Generic')) {
                valueColor = 'color:var(--color-text-secondary)';
            } else if (valueDisplay.includes('РАЗБЛОКИРОВАН') || valueDisplay.includes('MOD') || valueDisplay.includes('test-keys') || valueDisplay.includes('Нет данных')) {
                valueColor = 'color:var(--color-danger)';
            }
             else {
                valueColor = 'color:var(--color-text-primary)';
            }
        } 
        
        return `
            <div class="ios-list-item">
                <div class="flex justify-between items-start">
                    <div class="flex items-center space-x-3">
                        ${iconHtml}
                        <span class="text-sm font-medium" style="color:var(--color-text-primary)">${label}</span>
                    </div>
                    <span class="text-sm ${isMono ? 'font-mono' : ''} text-right break-words max-w-[50%]" style="${valueColor}">${valueDisplay}</span>
                </div>
                ${evidenceBlock}
            </div>
        `;
    }

    function handleFileSelection(event) {
        const file = event.target.files[0];
        if (file) {
            selectedFile = file;
            document.getElementById('fileNameDisplay').textContent = file.name;
            const analyzeButton = document.getElementById('analyzeButton');
            analyzeButton.disabled = false;
            analyzeButton.classList.remove('opacity-40');
            
            document.getElementById('resultsContainer').classList.add('hidden');
        }
    }

    async function startAnalysis() {
        if (!selectedFile) return;

        console.log(`[KRNT LOG] --- Начат анализ файла: ${selectedFile.name} ---`);
        console.log(`[KRNT LOG] Файл: ${selectedFile.name} | Размер: ${(selectedFile.size / 1024).toFixed(2)} KB`);


        document.getElementById('loadingOverlay').classList.remove('hidden');
        document.getElementById('resultsContainer').classList.add('hidden');
        
        document.getElementById('deviceInfo').innerHTML = '';
        document.getElementById('coreFindings').innerHTML = '';
        document.getElementById('injectionFindings').innerHTML = '';
        document.getElementById('shellFindings').innerHTML = '';
        document.getElementById('integrityFindings').innerHTML = '';
        document.getElementById('moddingFindings').innerHTML = '';
        document.getElementById('anomalyFindings').innerHTML = ''; 


        try {
            const reportContent = await getReportContent(selectedFile);
            if (!reportContent) {
                throw new Error("Не удалось извлечь содержимое отчета.");
            }

            const isMinimal = reportContent.trim().length < MIN_CONTENT_LENGTH; 
            await analyzeContent(reportContent, isMinimal); 

        } catch (error) {
            console.error("[KRNT LOG] Analysis failed:", error);

            document.getElementById('riskScoreDisplay').textContent = `ERR`;
            document.getElementById('riskVerdict').innerHTML = `
                ${icons.highRisk} 
                <span class="text-base font-semibold" style="color:var(--color-danger)">ОШИБКА: ${error.message}</span>
            `;
            document.getElementById('resultsContainer').classList.remove('hidden');
        } finally {
            document.getElementById('loadingOverlay').classList.add('hidden');
        }
    }

    async function getReportContent(file) {
        return new Promise(async (resolve, reject) => {
            if (file.name.endsWith('.txt')) {
                const reader = new FileReader();
                reader.onload = (e) => resolve(e.target.result);
                reader.onerror = reject;
                reader.readAsText(file);
            } else if (file.name.endsWith('.zip')) {
                const zip = new JSZip();
                try {
                    const content = await zip.loadAsync(file);
                    

                    const regex = new RegExp('bugreport-.*\\.txt$', 'i');
                    const matches = Object.keys(content.files).filter(fileName => regex.test(fileName));

                    if (matches.length === 0) {
                        return reject(new Error("В ZIP-архиве не найден файл 'bugreport-*.txt'."));
                    }
                    
                    const text = await content.file(matches[0]).async("string");
                    resolve(text);
                } catch (e) {
                    reject(new Error("Ошибка при чтении ZIP-файла."));
                }
            } else {
                reject(new Error("Неподдерживаемый формат файла. Требуется .txt или .zip."));
            }
        });
    }

    async function analyzeContent(content, isMinimal) {
        let totalRiskPoints = 0;
        let isCriticalRootingDetected = false; 
        
        const coreHtml = [];
        const injectionHtml = [];
        const shellHtml = [];
        const integrityHtml = [];
        const moddingHtml = [];
        const anomalyHtml = []; 
        
        const foundFindings = new Set(); 

        const device = {
            manufacturer: 'N/A',
            model: 'N/A',
            androidVersion: 'N/A',
            securityPatch: 'Не найдено',
            buildFingerprint: 'Не найдено',
            buildID: 'Не найдено', 
            bootloaderStatus: 'Неизвестно' 
        };

        
        const allDynamicIndicators = [
            ...indicators.core_systems.map(i => ({...i, category: 'core'})),
            ...indicators.injection_frameworks.map(i => ({...i, category: 'injection'})),
            ...indicators.shell_traces.map(i => ({...i, category: 'shell'})),
            ...indicators.firmware_integrity.map(i => ({...i, category: 'integrity'})),
            ...indicators.modding_tools.map(i => ({...i, category: 'modding'})),
            ...indicators.anomalies.map(i => ({...i, category: 'anomaly'})) 
        ];


        const lines = content.split('\n');
        
        const INFO_KEYS = ['manufacturer', 'model', 'androidVersion', 'securityPatch', 'buildFingerprint', 'buildID', 'bootloaderStatus'];
        let infoFoundCount = 0; 
        let lineIndex = 0;
        
        console.log(`[KRNT LOG] Содержимое отчета загружено. Длина: ${content.length} символов.`);
        
        
        for (const line of lines) {
            lineIndex++;
            
            if (infoFoundCount < INFO_KEYS.length) { 
                if (device.manufacturer === 'N/A') {
                    const mfrMatch = line.match(/ro\.product\.manufacturer=\[(.*?)\]/i);
                    if (mfrMatch) { device.manufacturer = mfrMatch[1].trim(); infoFoundCount++; }
                }
                if (device.model === 'N/A') {
                    const modelMatch = line.match(/ro\.product\.model=\[(.*?)\]/i);
                    if (modelMatch) { device.model = modelMatch[1].trim(); infoFoundCount++; }
                }
                if (device.androidVersion === 'N/A') {
                    const versionMatch = line.match(/ro\.build\.version\.release=\[(.*?)\]/i);
                    if (versionMatch) { device.androidVersion = versionMatch[1].trim(); infoFoundCount++; }
                }
                 if (device.securityPatch === 'Не найдено') {
                    const patchMatch = line.match(/ro\.build\.version\.security_patch=\[(.*?)\]/i);
                    if (patchMatch) { device.securityPatch = patchMatch[1].trim(); infoFoundCount++; }
                }
                if (device.buildFingerprint === 'Не найдено') {
                    const fpMatch = line.match(/Build fingerprint: '(.*?)'/);
                    if (fpMatch) { device.buildFingerprint = fpMatch[1].trim(); infoFoundCount++; }
                }
                if (device.buildID === 'Не найдено') {
                    const idMatch = line.match(/ro\.build\.display\.id=\[(.*?)\]/i);
                    if (idMatch) { device.buildID = idMatch[1].trim(); infoFoundCount++; }
                }
                if (device.bootloaderStatus === 'Неизвестно' || device.bootloaderStatus.startsWith('Оригинал')) {
                    const blMatch = line.match(/(androidboot\.status=(unlocked|tampered)|fastboot\s+oem\s+unlock|orange\s+state|ro\.boot\.flash\.locked=0)/i); 
                    if (blMatch) { 
                        const statusDetail = blMatch[2] || (blMatch[1] ? blMatch[1].split('=')[1] : 'Key');
                        device.bootloaderStatus = `РАЗБЛОКИРОВАН/MOD (${statusDetail.toUpperCase()})`; 
                    } else if (line.match(/androidboot\.status=locked|ro\.boot\.flash\.locked=1/i)) {
                         device.bootloaderStatus = 'Оригинал (Locked)';
                    }
                }
            }
            
            if (!isMinimal) {
                for (const item of allDynamicIndicators) {
                    const match = line.match(item.regex);
                    if (match) {
                        
                        let description = item.description;
                        if (item.description.includes('$1') && (match[1] || match[2] || match[3])) {
                             description = item.description.replace(/\$1/g, match[1] || match[2] || match[3] || '').trim();
                        } else if (item.description.includes('$2') && (match[2] || match[3])) {
                            description = item.description.replace(/\$2/g, match[2] || match[3] || '').trim();
                        }
                        
                        description = description.replace(/(\s*\[\s*\]\s*)/g, '').trim();


                        if (!foundFindings.has(description)) {
                            foundFindings.add(description); 

                            totalRiskPoints += item.risk;
                            const evidence = `[L:${lineIndex}] ${line}`; 
                            
                            if (item.isCritical) {
                                isCriticalRootingDetected = true;
                            }
                            
                            console.log(`[KRNT LOG] | FIND | +${item.risk} RP | ${description}`);

                            const findingItem = createFindingItem(description, item.risk, evidence);
                            if (item.category === 'core') {
                                coreHtml.push(findingItem);
                            } else if (item.category === 'injection') {
                                injectionHtml.push(findingItem);
                            } else if (item.category === 'shell') {
                                shellHtml.push(findingItem);
                            } else if (item.category === 'integrity') {
                                integrityHtml.push(findingItem);
                            } else if (item.category === 'modding') {
                                moddingHtml.push(findingItem);
                            } else if (item.category === 'anomaly') { 
                                anomalyHtml.push(findingItem);
                            }
                        }
                    }
                }
            }
        }
        
        // --- ЗАГЛУШКИ ДЛЯ ИНФОРМАЦИИ ОБ УСТРОЙСТВЕ ---
        if (isMinimal) {
            // Использование нейтральных заглушек вместо "Mock" для минимальных файлов
            const tag = '(Нет данных в файле)';
            device.manufacturer = `Generic Vendor ${tag}`;
            device.model = `Generic Model ${tag}`;
            device.androidVersion = `Undetected ${tag}`;
            device.securityPatch = `Undetected ${tag}`;
            device.buildID = `Undetected ${tag}`;
            device.buildFingerprint = `Undetected ${tag}`;
            if (device.bootloaderStatus === 'Неизвестно' || device.bootloaderStatus.startsWith('Оригинал')) {
                 device.bootloaderStatus = 'Неизвестно (Нет данных)';
            }
        } else {
             // Чистка 'N/A' для неполных отчетов (но не минимальных)
             device.manufacturer = device.manufacturer === 'N/A' ? 'Generic Vendor' : device.manufacturer;
             device.model = device.model === 'N/A' ? 'Generic Model' : device.model;
             device.androidVersion = device.androidVersion === 'N/A' ? '12.0 (Undetected)' : device.androidVersion;
             device.securityPatch = device.securityPatch === 'Не найдено' ? '20XX-XX-XX (Undetected)' : device.securityPatch;
             device.buildID = device.buildID === 'Не найдено' ? 'Build ID (Undetected)' : device.buildID;
             device.buildFingerprint = device.buildFingerprint === 'Не найдено' ? 'Fingerprint (Undetected)' : device.buildFingerprint;
             device.bootloaderStatus = device.bootloaderStatus === 'Неизвестно' ? 'Неизвестно (No Status Tag)' : device.bootloaderStatus;
        }


        console.log(`[KRNT LOG] --- Анализ завершен. ---`);
        console.log(`[KRNT LOG] Обнаружено уникальных следов: ${foundFindings.size}`);
        console.log(`[KRNT LOG] Сумма RP: ${totalRiskPoints}`);
        console.log(`[KRNT LOG] Критический рут: ${isCriticalRootingDetected ? 'ДА' : 'НЕТ'}`);
        

        const shortFingerprint = device.buildFingerprint.length > 50 
            ? device.buildFingerprint.substring(0, 47) + '...' 
            : device.buildFingerprint;


        const infoHtml = `
            ${createFindingItem(`Модель`, `${device.model} (${device.manufacturer})`, null, 'info')}
            ${createFindingItem(`Версия Android`, device.androidVersion, null, 'info')}
            ${createFindingItem(`Патч Безопасности`, device.securityPatch, null, 'info')}
            ${createFindingItem(`ID Сборки`, device.buildID, null, 'info')}
            ${createFindingItem(`Отпечаток (часть)`, shortFingerprint, null, 'info')}
            ${createFindingItem(`Статус Загрузчика`, device.bootloaderStatus, null, 'info')}
        `;
        document.getElementById('deviceInfo').innerHTML = infoHtml;


        
        const dynamicContentMissing = isMinimal 
            ? minimalFileMessage 
            : cleanStatusMessage; 
            
        document.getElementById('coreFindings').innerHTML = coreHtml.length > 0
            ? coreHtml.join('')
            : cleanStatusMessage('Core Root Systems');
            
        document.getElementById('injectionFindings').innerHTML = injectionHtml.length > 0
            ? injectionHtml.join('')
            : cleanStatusMessage('Injection Frameworks');
            
        document.getElementById('shellFindings').innerHTML = shellHtml.length > 0
            ? shellHtml.join('')
            : cleanStatusMessage('Shell/Privilege Traces');

        document.getElementById('integrityFindings').innerHTML = integrityHtml.length > 0
            ? integrityHtml.join('')
            : cleanStatusMessage('Integrity Bypasses/Firmware');
            
        document.getElementById('moddingFindings').innerHTML = moddingHtml.length > 0
            ? moddingHtml.join('')
            : cleanStatusMessage('Modding/Virtualization Tools');
            
        document.getElementById('anomalyFindings').innerHTML = anomalyHtml.length > 0
            ? anomalyHtml.join('')
            : cleanStatusMessage('Anomalous System Activity');



        const finalRiskPoints = isMinimal ? 0 : totalRiskPoints;
        
        let riskPercentage;
        if (isCriticalRootingDetected) {

             riskPercentage = Math.max(95.00, (finalRiskPoints / MAX_RISK_SCORE) * 100);
        } else {
             riskPercentage = Math.min(100.00, (finalRiskPoints / MAX_RISK_SCORE) * 100); 
        }

        const formattedRisk = riskPercentage.toFixed(2);
        
        let verdictText;
        let verdictColor;
        let verdictIcon;

        if (riskPercentage >= 95) {
            verdictText = "КРИТИЧЕСКИЙ РИСК (ROOT ЯДРО)";
            verdictColor = "color:var(--color-danger)";
            verdictIcon = icons.highRisk;
        } else if (riskPercentage > 75) {
            verdictText = "КРИТИЧЕСКИЙ РИСК";
            verdictColor = "color:var(--color-danger)";
            verdictIcon = icons.highRisk;
        } else if (riskPercentage > 30) {
            verdictText = "ВЫСОКИЙ РИСК";
            verdictColor = "color:var(--color-warning)";
            verdictIcon = icons.mediumRisk;
        } else if (riskPercentage > 0.01) {
            verdictText = "НИЗКИЙ РИСК";
            verdictColor = "color:var(--color-low-risk)";
            verdictIcon = icons.lowRisk;
        } else {
            verdictText = "ЧИСТЫЙ ОТЧЕТ";
            verdictColor = "color:var(--color-safe)";
            verdictIcon = icons.clean;
        }

        document.getElementById('riskScoreDisplay').textContent = `${formattedRisk}%`;
        document.getElementById('riskVerdict').innerHTML = `
            ${verdictIcon}
            <span class="text-base font-semibold" style="${verdictColor}">${verdictText}</span>
        `;
        
        document.getElementById('resultsContainer').classList.remove('hidden');
    }

</script>

</body>
</html>
